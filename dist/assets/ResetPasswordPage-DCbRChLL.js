import{f as k,r as t,j as e,L as z,h as S,i as C}from"./index-4AM2v5zk.js";import{A as x}from"./AuthLayout-BYg2Ifkx.js";import{C as E,v as G}from"./validators-zkfZzeRC.js";import{C as L}from"./circle-check-C5tol9Y-.js";import{L as P,E as Y,a as A}from"./lock-DM6hVymQ.js";import"./PublicLayout-D-U2DQrY.js";const V=()=>{const[b]=k(),o=b.get("oobCode"),[r,h]=t.useState({password:"",confirm:""}),[n,c]=t.useState(!1),[y,g]=t.useState(!1),[d,m]=t.useState(!1),[p,a]=t.useState(""),j=async s=>{s.preventDefault(),a("");const i=G(r.password);if(i.length>0){a(i[0]);return}if(r.password!==r.confirm){a("Şifreler eşleşmiyor.");return}if(!o){a("Geçersiz veya süresi dolmuş bağlantı.");return}m(!0);try{await S(C,o,r.password),g(!0)}catch(l){l.code==="auth/expired-action-code"?a("Bağlantının süresi dolmuş. Yeni sıfırlama talebi oluşturun."):l.code==="auth/invalid-action-code"?a("Geçersiz bağlantı. Yeni sıfırlama talebi oluşturun."):a("Bir hata oluştu. Lütfen tekrar deneyin.")}finally{m(!1)}};return y?e.jsx(x,{title:"Şifre Güncellendi",subtitle:"",children:e.jsxs("div",{className:"flex flex-col items-center text-center gap-6 py-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-3xl flex items-center justify-center",style:{background:"rgba(58,138,90,0.1)",border:"1px solid rgba(58,138,90,0.2)"},children:e.jsx(L,{size:36,style:{color:"#3A8A5A"}})}),e.jsx("p",{className:"text-cream",children:"Şifreniz başarıyla güncellendi. Yeni şifrenizle giriş yapabilirsiniz."}),e.jsx(z,{to:"/giris",className:"btn-primary px-8 py-3",children:"Giriş Yap"})]})}):e.jsx(x,{title:"Yeni Şifre Belirle",subtitle:"Güvenli ve hatırlanabilir bir şifre seçin.",children:e.jsxs("form",{onSubmit:j,className:"flex flex-col gap-5",noValidate:!0,children:[p&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl text-sm",style:{background:"rgba(200,64,64,0.1)",border:"1px solid rgba(200,64,64,0.25)",color:"#E87070"},children:[e.jsx(E,{size:16,className:"flex-shrink-0 mt-0.5"}),p]}),[{id:"password",label:"Yeni Şifre",ph:"En az 8 karakter",show:n,toggle:()=>c(s=>!s),field:"password"},{id:"confirm",label:"Yeni Şifre Tekrar",ph:"Şifrenizi tekrar girin",show:n,toggle:()=>c(s=>!s),field:"confirm"}].map(({id:s,label:i,ph:l,show:f,toggle:v,field:u})=>e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{htmlFor:s,className:"text-xs font-mono tracking-wide uppercase",style:{color:"var(--mist)"},children:i}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx(P,{size:16,style:{color:"var(--mist)"}})}),e.jsx("input",{id:s,type:f?"text":"password",value:r[u],onChange:w=>h(N=>({...N,[u]:w.target.value})),placeholder:l,className:"input-field pl-10 pr-10"}),e.jsx("button",{type:"button",onClick:v,className:"absolute right-3.5 top-1/2 -translate-y-1/2 opacity-50 hover:opacity-100 transition-opacity",children:f?e.jsx(Y,{size:16,className:"text-cream"}):e.jsx(A,{size:16,className:"text-cream"})})]})]},s)),e.jsx("button",{type:"submit",disabled:d,className:"btn-primary w-full py-3.5 text-base disabled:opacity-50 disabled:cursor-not-allowed",children:d?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-ink border-t-transparent rounded-full animate-spin"}),"Güncelleniyor..."]}):"Şifremi Güncelle"})]})})};export{V as default};
