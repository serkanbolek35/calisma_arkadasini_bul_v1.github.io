import{q as b,w as p,p as m,t as h,v as M,x as i,y as c,z as f,A as l}from"./index-BBddTGOj.js";const D=async s=>{const t=b(m(c,"matches"),p("users","array-contains",s),p("status","in",["pending","active"]));return(await h(t)).docs.map(n=>({id:n.id,...n.data()}))},v=async(s,t)=>{await f(i(c,"matches",s),{status:t?"active":"ended",respondedAt:l()})},x=async(s,t="")=>{await f(i(c,"matches",s),{status:"ended",endedAt:l(),endReason:t})},q=async(s,t=[],y="")=>{const n=await h(m(c,"users")),r=[];for(const e of n.docs)if(e.id!==s)try{const a=await M(i(c,"users",e.id,"preferences",e.id));if(!a.exists())continue;const d=a.data(),u=d.subjects||[],o=t.filter(w=>u.includes(w));if(o.length===0)continue;const g=Math.round(o.length/Math.max(t.length,u.length)*100);r.push({uid:e.id,...e.data(),commonSubjects:o,compatibilityScore:g,campus:d.campus||""})}catch{continue}return r.sort((e,a)=>a.compatibilityScore-e.compatibilityScore)};export{x as e,q as f,D as g,v as r};
