import{c as O,r as n,j as e,o as R,A as y}from"./index-BBddTGOj.js";import{A as M}from"./AppLayout-BGUvaGkJ.js";import{g as N,c as P,a as z,u as B}from"./session.service-DDr7ccXe.js";import{c as S,B as L}from"./PublicLayout-CIYkHypp.js";import{C as T}from"./circle-check-R-dCLeZ1.js";import"./settings-Be80CAJe.js";import"./log-out-78Q37P80.js";/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=S("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=S("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),F=()=>{const[a,r]=n.useState(0),[i,l]=n.useState(!1),c=n.useRef(null),t=()=>{l(!0),c.current=setInterval(()=>r(u=>u+1),1e3)},o=()=>{l(!1),clearInterval(c.current)};return{seconds:a,running:i,start:t,stop:o,reset:()=>{o(),r(0)},format:()=>{const u=Math.floor(a/3600),f=Math.floor(a%3600/60),p=a%60;return`${u>0?u+":":""}${String(f).padStart(2,"0")}:${String(p).padStart(2,"0")}`}}},E=({onSubmit:a,onSkip:r})=>{const[i,l]=n.useState({focusLevel:3,stressLevel:3,productivity:3}),c=[{key:"focusLevel",label:"Odaklanma DÃ¼zeyi"},{key:"stressLevel",label:"Stres Seviyesi"},{key:"productivity",label:"Verimlilik"}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)",backdropFilter:"blur(8px)"},children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl p-8",style:{background:"var(--ink-50)",border:"1px solid rgba(245,237,216,0.12)"},children:[e.jsx("h2",{className:"font-display text-2xl font-bold text-cream mb-2",children:"Oturum TamamlandÄ±! ðŸŽ‰"}),e.jsx("p",{className:"text-sm mb-6",style:{color:"var(--mist)"},children:"Bu oturumu deÄŸerlendir"}),e.jsx("div",{className:"flex flex-col gap-5",children:c.map(({key:t,label:o})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-cream",children:o}),e.jsxs("span",{className:"text-sm font-mono",style:{color:"var(--amber)"},children:[i[t],"/5"]})]}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(d=>e.jsx("button",{onClick:()=>l(m=>({...m,[t]:d})),className:"flex-1 h-8 rounded-lg text-sm font-mono font-bold transition-all",style:{background:i[t]>=d?"var(--amber)":"rgba(245,237,216,0.08)",color:i[t]>=d?"var(--ink)":"var(--mist)"},children:d},d))})]},t))}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:()=>a(i),className:"btn-primary flex-1 py-3",children:"Kaydet"}),e.jsx("button",{onClick:r,className:"btn-outline flex-1 py-3",children:"Atla"})]})]})})},G=({subjects:a,onClose:r,onSave:i})=>{const[l,c]=n.useState({subject:a[0]||"",plannedDuration:25});return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)",backdropFilter:"blur(8px)"},children:e.jsxs("div",{className:"w-full max-w-sm rounded-2xl p-8",style:{background:"var(--ink-50)",border:"1px solid rgba(245,237,216,0.12)"},children:[e.jsx("h2",{className:"font-display text-xl font-bold text-cream mb-6",children:"Yeni Oturum"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-xs font-mono tracking-widest uppercase",style:{color:"var(--mist)"},children:"Ders"}),a.length>0?e.jsxs("select",{value:l.subject,onChange:t=>c(o=>({...o,subject:t.target.value})),className:"input-field",style:{background:"rgba(245,237,216,0.06)",color:"var(--cream)"},children:[a.map(t=>e.jsx("option",{value:t,style:{background:"var(--ink-50)"},children:t},t)),e.jsx("option",{value:"Genel Ã‡alÄ±ÅŸma",style:{background:"var(--ink-50)"},children:"Genel Ã‡alÄ±ÅŸma"})]}):e.jsx("input",{value:l.subject,onChange:t=>c(o=>({...o,subject:t.target.value})),placeholder:"Ders adÄ± gir",className:"input-field"})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-xs font-mono tracking-widest uppercase",style:{color:"var(--mist)"},children:"SÃ¼re (dakika)"}),e.jsx("div",{className:"flex gap-2",children:[25,45,60,90].map(t=>e.jsxs("button",{type:"button",onClick:()=>c(o=>({...o,plannedDuration:t})),className:"flex-1 py-2 rounded-xl text-sm font-mono transition-all",style:{background:l.plannedDuration===t?"var(--amber)":"rgba(245,237,216,0.06)",color:l.plannedDuration===t?"var(--ink)":"var(--mist)",border:l.plannedDuration===t?"none":"1px solid rgba(245,237,216,0.1)"},children:[t,"dk"]},t))})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>i(l),className:"btn-primary flex-1 py-3",children:"BaÅŸlat"}),e.jsx("button",{onClick:r,className:"btn-outline flex-1 py-3",children:"Ä°ptal"})]})]})})},J=()=>{const{currentUser:a}=O(),r=F(),[i,l]=n.useState([]),[c,t]=n.useState([]),[o,d]=n.useState(!0),[m,u]=n.useState(null),[f,p]=n.useState(!1),[w,h]=n.useState(!1),[g,j]=n.useState(null);n.useEffect(()=>{if(!a)return;(async()=>{const[x,b]=await Promise.all([N(a.uid,20),R(a.uid)]);l(x),t((b==null?void 0:b.subjects)||[]),d(!1)})()},[a]);const D=async s=>{p(!1);const x=await P(a.uid,{subject:s.subject,plannedDuration:s.plannedDuration,startedAt:y(),status:"active"});u({id:x,subject:s.subject,plannedDuration:s.plannedDuration}),r.reset(),r.start()},C=async()=>{r.stop();const s=Math.floor(r.seconds/60);await B(m.id,"completed",{durationMinutes:s,endedAt:y()}),j(m.id),u(null),h(!0);const x=await N(a.uid,20);l(x)},A=async s=>{g&&await z(g,a.uid,s),h(!1),j(null)};return e.jsxs(M,{title:"Ã‡alÄ±ÅŸma OturumlarÄ±",children:[f&&e.jsx(G,{subjects:c,onClose:()=>p(!1),onSave:D}),w&&e.jsx(E,{onSubmit:A,onSkip:()=>{h(!1),j(null)}}),m?e.jsxs("div",{className:"mb-8 p-8 rounded-2xl text-center",style:{background:"linear-gradient(135deg, rgba(232,160,32,0.1) 0%, rgba(90,122,90,0.06) 100%)",border:"1px solid rgba(232,160,32,0.25)"},children:[e.jsxs("p",{className:"text-xs font-mono tracking-widest uppercase mb-2",style:{color:"var(--amber)"},children:["Aktif Oturum â€” ",m.subject]}),e.jsx("div",{className:"font-mono text-6xl font-bold text-cream my-6 tracking-tight",children:r.format()}),e.jsxs("p",{className:"text-sm mb-6",style:{color:"var(--mist)"},children:["Odak modunda Ã§alÄ±ÅŸÄ±yorsun. Hedef: ",m.plannedDuration," dakika"]}),e.jsxs("button",{onClick:C,className:"inline-flex items-center gap-2 px-8 py-3.5 rounded-xl font-semibold transition-all",style:{background:"rgba(200,64,64,0.15)",color:"#E87070",border:"1px solid rgba(200,64,64,0.3)"},children:[e.jsx(I,{size:16})," Oturumu Tamamla"]})]}):e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-semibold text-cream",children:"OturumlarÄ±n"}),e.jsxs("p",{className:"text-sm mt-0.5",style:{color:"var(--mist)"},children:[i.filter(s=>s.status==="completed").length," oturum tamamlandÄ±"]})]}),e.jsxs("button",{onClick:()=>p(!0),className:"btn-primary px-5 py-2.5 flex items-center gap-2",children:[e.jsx(k,{size:15})," Oturum BaÅŸlat"]})]}),o?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"w-8 h-8 border-2 rounded-full animate-spin",style:{borderColor:"rgba(245,237,216,0.15)",borderTopColor:"var(--amber)"}})}):i.length===0?e.jsxs("div",{className:"glass-card p-16 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"â±"}),e.jsx("h3",{className:"font-display text-2xl font-bold text-cream mb-2",children:"Ä°lk oturumunu baÅŸlat"}),e.jsx("p",{className:"text-sm mb-8",style:{color:"var(--mist)"},children:"Odak modunda Ã§alÄ±ÅŸ, sonunda deÄŸerlendir ve ilerlemeyi takip et."}),e.jsxs("button",{onClick:()=>p(!0),className:"btn-primary px-8 py-3 inline-flex items-center gap-2",children:[e.jsx(k,{size:16})," Åžimdi BaÅŸlat"]})]}):e.jsx("div",{className:"flex flex-col gap-3",children:i.map((s,x)=>{var v;const b=(v=s.createdAt)!=null&&v.toDate?s.createdAt.toDate():new Date(s.createdAt||0);return e.jsxs("div",{className:"glass-card p-4 flex items-center gap-4 hover:border-white/15 transition-all",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0",style:{background:s.status==="completed"?"rgba(58,138,90,0.12)":"rgba(232,160,32,0.1)"},children:s.status==="completed"?e.jsx(T,{size:18,style:{color:"#5ABF8A"}}):e.jsx(L,{size:18,style:{color:"var(--amber)"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-body font-medium text-cream",children:s.subject||"Genel Ã‡alÄ±ÅŸma"}),e.jsx("p",{className:"text-xs",style:{color:"var(--mist)"},children:b.toLocaleDateString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[s.durationMinutes>0&&e.jsxs("p",{className:"text-sm font-mono font-bold text-cream",children:[s.durationMinutes,"dk"]}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:s.status==="completed"?"#5ABF8A":s.status==="active"?"var(--amber)":"var(--mist)"},children:s.status==="completed"?"TamamlandÄ±":s.status==="active"?"Devam ediyor":"PlanlandÄ±"})]})]},x)})})]})};export{J as default};
